pico-8 cartridge // http://www.pico-8.com
version 20
__lua__
--ludum dare 46
--by trampolinetales

function _init()
	cls()
	print("loading...",88,122)
	
	cartdata("tt_ld46")
	
	for x=1,36 do
		add(world,{})
		for y=1,20 do
			world[x][y]=7
			if x<=9 or x>=29 then
				world[x][y]=8
			end
			if x>9 and x<29 and y==16 then
				world[x][y]=3+flr(rnd()*3)
			end
			if y>=17 then
				world[x][y]=6
			end
		end
	end
end

function _update60()
	loop()
end
-->8
--main game loop

char_x=128
char_y=96
char_delta_x=0
char_delta_y=0
flip_char=false
bounce_cycle=1
walk_cycle=0
walk_mod=1
world={}

function loop()
	cls()
	
	move_char()
	
	draw_world()
	draw_character()
	
	print("pos:"..char_x..", "..char_y)
	print("dlt:"..char_delta_x..", "..char_delta_y)
end

function dash()
	if btn(‚¨ÖÔ∏è) then
		char_delta_x=-2.35
	elseif btn(‚û°Ô∏è) then
		char_delta_x=2.35
	end
	
	char_delta_y=-2
end

function move_char()
	if btn(‚û°Ô∏è) then
		if char_delta_x==0 then
			char_delta_x=0.6
		end
		if char_delta_x<1 then
			char_delta_x+=0.04
		end
		flip_char=false
		bounce_cycle+=1
	elseif btn(‚¨ÖÔ∏è) then
		if char_delta_x==0 then
			char_delta_x=-0.6
		end
		if char_delta_x>-1 then
			char_delta_x-=0.04
		end
		flip_char=true
		bounce_cycle+=1
	else
		walk_cycle=0
		bounce_cycle=1
		if char_delta_x<0 then
			char_delta_x+=0.04
		elseif char_delta_x>0 then
			char_delta_x-=0.04
		end
		
		if char_delta_x<=0.05 and char_delta_x>=-0.05 then
			char_delta_x=0
		end
		
		if char_delta_y>=4 then
			char_delta_y=4
		end
	end
	
	if btn(üÖæÔ∏è) and char_y>=96 then
		dash()
	end
	
	if abs(char_delta_x)>1 then
		if char_delta_x<0 then
			char_delta_x+=0.04
		elseif char_delta_x>0 then
			char_delta_x-=0.04
		end
	end
	
	if char_delta_y<4 then
		char_delta_y+=0.1
	end

	char_x+=char_delta_x
	char_y+=char_delta_y
	
	if char_x>#world*8-140 then
		char_x=#world*8-140
	end
	
	if char_x<4 then
		char_x=4
	end
	
	if char_y>96 then
		char_y=96
	end
end

function draw_world()
	s_num=0
	for x=1,18 do
		for y=1,18 do
			spr(world[flr(char_x/8)+x][flr((char_y-80)/8)+y],-16+x*8-char_x%8,-16+y*8-char_y%8)
		end
	end
end

function draw_character()
	x_mod=0
	x_offset=-1
	y_offset=0
	if flip_char then
		x_mod=8
		x_offset=7
	end
	
	if bounce_cycle%5==0 then
		if walk_cycle>=4 then
			walk_mod=-1
		elseif walk_cycle<=1 then
			walk_mod=1
		end
		walk_cycle+=walk_mod
	end
	
	if walk_cycle==2 or walk_cycle==3 then
		y_offset=1
	end
	
	spr(9+walk_cycle,59+x_mod-x_offset,char_y-y_offset,1,1,flip_char)
end
__gfx__
000000000000777077700000111111111111111111111111bbbbbbbb111111116666666608866880088668800886688008866880088668800000000000000000
0000000000007e707e700000111111111111111111111111bbbbbbbb111111116666666688888888888888888888888888888888888888880000000000000000
000000000000777777700000111111111111111111111111bbbbbbbb111111116666666688575758885757588857575888575758885757580000000000000000
000000007000071717000000111111111111111b11111111bbbbbbbb111111116666666688888888888888888888888888888888888888880000000000000000
000000007007777777000000b11b111b1b11b11b1b1b111bbbbbbbbb111111116666666608888880088888800888888008888880088888800000000000000000
000000000777777770000000bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb111111116666666600888800008888000088880000888800008888000000000000000000
000000000777777770000000bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb111111116666666600888800008888500088885005888800058888000000000000000000
000000000707007070000000bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb111111116666666600500500005000000500000000000050000005000000000000000000
__label__
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888171717188888
88888eeeeee888888888888888888888888888888888888888888888888888888888888888888888888ff8ff8888228822888222822888888821177777128888
8888ee888ee88888888888888888888888888888888888888888888888888888888888888888888888ff888ff888222222888222822888882217177777122888
888eee8e8ee88888e88888888888888888888888888888888888888888888888888888888888888888ff888ff888282282888222888888228881777777188888
888eee8e8ee8888eee8888888888888888888888888888888888888888888888888888888888888888ff888ff888222222888888222888228882117771288888
888eee8e8ee88888e88888888888888888888888888888888888888888888888888888888888888888ff888ff888822228888228222888882282817771288888
888eee888ee888888888888888888888888888888888888888888888888888888888888888888888888ff8ff8888828828888228222888888822881112888888
888eeeeeeee888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
566655555ccc55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
565557775c5c55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
566555555c5c55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
565557775c5c55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
565555555ccc55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5eee5e5e5ee555ee5eee5eee55ee5ee5555555555666566556665666557555755555555555555555555555555555555555555555555555555555555555555555
5e555e5e5e5e5e5555e555e55e5e5e5e555555555565565655655565575555575555555555555555555555555555555555555555555555555555555555555555
5ee55e5e5e5e5e5555e555e55e5e5e5e555555555565565655655565575555575555555555555555555555555555555555555555555555555555555555555555
5e555e5e5e5e5e5555e555e55e5e5e5e555555555565565655655565575555575555555555555555555555555555555555555555555555555555555555555555
5e5555ee5e5e55ee55e55eee5ee55e5e555556665666565656665565557555755555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
555555bb5bbb5bbb5bbb5bb55bbb5bbb5bbb55755c5c5ccc5ccc55555c555cc55c5c5c5555555c5c5ccc5ccc5ccc5c5c5ccc5c5c557555555555555555555555
55555b555b5b5b5b55b55b5b5b5b55b55b5b57555c5c55c555c555555c555c5c5c5c5c5555555c5c5c5c5c5c5ccc5c5c5c5c5c5c555755555555555555555555
55555b555bbb5bb555b55b5b5bbb55b55bbb5755555555c555c555555c555c5c5ccc5ccc55555c5c5ccc5cc55c5c5c5c5ccc5555555755555555555555555555
55555b555b5b5b5b55b55b5b5b5b55b55b5b5755555555c555c555555c555c5c555c5c5c55555ccc5c5c5c5c5c5c5c5c5c555555555755555555555555555555
555555bb5b5b5b5b55b55bbb5b5b55b55b5b5575555555c555c55ccc5ccc5ccc555c5ccc5ccc5ccc5c5c5c5c5c5c55cc5c555555557555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5eee5ee55ee555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5e555e5e5e5e55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5ee55e5e5e5e55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5e555e5e5e5e55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5eee5e5e5eee55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5eee5e5e5ee555ee5eee5eee55ee5ee5555555555656566656655666566656665655566655755575555555555555555555555555555555555555555555555555
5e555e5e5e5e5e5555e555e55e5e5e5e555555555656565656565656556556555655565657555557555555555555555555555555555555555555555555555555
5ee55e5e5e5e5e5555e555e55e5e5e5e555555555656566656565666556556655666565657555557555555555555555555555555555555555555555555555555
5e555e5e5e5e5e5555e555e55e5e5e5e555555555656565556565656556556555656565657555557555555555555555555555555555555555555555555555555
5e5555ee5e5e55ee55e55eee5ee55e5e555556665566565556665656556556665666566655755575555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555655556655665666557555755555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555655565656565656575555575555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555655565656565666575555575555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555655565656565655575555575555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555666566556655655557555755555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5eee5ee55ee555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5e555e5e5e5e55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5ee55e5e5e5e55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5e555e5e5e5e55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5eee5e5e5eee55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5eee5e5e5ee555ee5eee5eee55ee5ee5555556555566556656665575557555555555555555555555555555555555555555555555555555555555555555555555
5e555e5e5e5e5e5555e555e55e5e5e5e555556555656565656565755555755555555555555555555555555555555555555555555555555555555555555555555
5ee55e5e5e5e5e5555e555e55e5e5e5e555556555656565656665755555755555555555555555555555555555555555555555555555555555555555555555555
5e555e5e5e5e5e5555e555e55e5e5e5e555556555656565656555755555755555555555555555555555555555555555555555555555555555555555555555555
5e5555ee5e5e55ee55e55eee5ee55e5e555556665665566556555575557555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5555566655555575566655555cc5557557575ccc5ccc5ccc5ccc5ccc555555555555555555555555555555555555555555555555555555555555555555555555
55555655577757555655557555c555575557555c5c5c5c5c5c5c5c5c555555555555555555555555555555555555555555555555555555555555555555555555
55555665555557555665577755c55557557555cc5c5c5c5c5c5c5c5c555555555555555555555555555555555555555555555555555555555555555555555555
55555655577757555655557555c555575755555c5c5c5c5c5c5c5c5c555555555555555555555555555555555555555555555555555555555555555555555555
5555565555555575565555555ccc557557575ccc5ccc5ccc5ccc5ccc555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
555555bb5b5555bb5575557555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555b555b555b555755555755555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555b555b555bbb5755555755555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555b555b55555b5755555755555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
555555bb5bbb5bb55575557555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5eee5ee55ee555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5e555e5e5e5e55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5ee55e5e5e5e55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5e555e5e5e5e55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5eee5e5e5eee55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
82888222822882228888822882228882822882828888888888888888888888888888888888888888888888888888822282228882822282288222822288866688
82888828828282888888882882828828882882828888888888888888888888888888888888888888888888888888888288828828828288288282888288888888
82888828828282288888882882828828882882228888888888888888888888888888888888888888888888888888822288828828822288288222822288822288
82888828828282888888882882828828882888828888888888888888888888888888888888888888888888888888828888828828828288288882828888888888
82228222828282228888822282228288822288828888888888888888888888888888888888888888888888888888822288828288822282228882822288822288
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888

